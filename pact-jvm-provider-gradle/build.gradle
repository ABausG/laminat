buildscript {
  repositories {
    maven {
      url "http://spvx10419.hq.local:8081/nexus/content/groups/public"
    }
    jcenter()
  }
  dependencies {
    classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:0.6'
  }
}

apply plugin: 'com.jfrog.bintray'
apply plugin: 'java-gradle-plugin'
apply plugin: 'maven-publish'

dependencies {
    compile gradleApi(), localGroovy()
    compile(project(":pact-jvm-provider_${project.scalaVersion}")) {
      exclude module: 'groovy-all'
    }
}

publishing {
  publications {
    maven(MavenPublication) {
      from components.java

      artifact sourceJar {
        classifier "sources"
      }
      artifact javadocJar {
        classifier "javadoc"
      }
    }
  }
}

bintray {
  if (project.hasProperty('bintrayUser')) {
    user = bintrayUser
    key = bintrayKey
  }

  publications = ['maven']

  dryRun = false //Whether to run this as dry-run, without deploying
  publish = true //If version should be auto published after an upload
  pkg {
    repo = 'maven'
    name = project.name
    desc = new File(projectDir, 'README.md').text
    websiteUrl = 'https://github.com/DiUS/pact-jvm/tree/master/pact-jvm-provider-gradle'
    issueTrackerUrl = 'https://github.com/DiUS/pact-jvm/issues'
    vcsUrl = 'https://github.com/DiUS/pact-jvm.git'
    licenses = ['Apache-2.0']
    labels = ['pact', 'gradle', 'gradle plugin']
    publicDownloadNumbers = true
    //Optional version descriptor
    version {
      attributes = ['gradle-plugin': "au.com.dius.pact:au.com.dius:${project.name}"]
    }
  }
}
